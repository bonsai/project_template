<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>枠付き画像ジェネレーター</title>
<style>
#preview {
  max-width: 300px;
  margin-top: 20px;
}
</style>
</head>
<body>

<h2>画像アップロード（枠付き自動合成）</h2>

<input type="file" id="file" accept="image/*">

<div>
  <label><input type="radio" name="shape" value="square" checked> 四角</label>
  <label><input type="radio" name="shape" value="circle"> 丸</label>
</div>

<img id="preview">

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script>
$('#file').on('change', function () {
    const file = this.files[0];
    if (!file) return;

    const formData = new FormData();
    formData.append("image", file);
    formData.append("shape", $('input[name="shape"]:checked').val());

    $.ajax({
        // Vercel Ruby API Endpoint
        url: "/api/upload",
        type: "POST",
        data: formData,
        processData: false,
        contentType: false,
        xhrFields: { responseType: 'blob' },
        success: function (blob) {
            const url = URL.createObjectURL(blob);
            $('#preview').attr('src', url);
        }
    });
});
</script>

</body>
</html>
